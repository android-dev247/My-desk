<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DDoSæ£€æµ‹ä¸é˜²æŠ¤ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        h1 {
            color: #4fc3f7;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(79, 195, 247, 0.5);
        }
        
        .subtitle {
            color: #b0bec5;
            font-size: 1.1rem;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: rgba(30, 40, 50, 0.7);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.4);
        }
        
        .card h2 {
            color: #81d4fa;
            font-size: 1.4rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.05);
        }
        
        .stat-value {
            font-weight: bold;
            color: #4fc3f7;
        }
        
        .danger {
            color: #ff5252;
        }
        
        .warning {
            color: #ffb74d;
        }
        
        .safe {
            color: #69f0ae;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
            justify-content: center;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }
        
        .simulate-btn {
            background: linear-gradient(to right, #ff6b6b, #ff5252);
            color: white;
        }
        
        .simulate-btn:hover {
            background: linear-gradient(to right, #ff5252, #ff1744);
            box-shadow: 0 0 15px rgba(255, 82, 82, 0.5);
        }
        
        .stop-btn {
            background: linear-gradient(to right, #4db6ac, #26a69a);
            color: white;
        }
        
        .stop-btn:hover {
            background: linear-gradient(to right, #26a69a, #009688);
            box-shadow: 0 0 15px rgba(38, 166, 154, 0.5);
        }
        
        .reset-btn {
            background: linear-gradient(to right, #5c6bc0, #3f51b5);
            color: white;
        }
        
        .reset-btn:hover {
            background: linear-gradient(to right, #3f51b5, #303f9f);
            box-shadow: 0 0 15px rgba(63, 81, 181, 0.5);
        }
        
        .chart-container {
            height: 200px;
            margin-top: 20px;
        }
        
        /* æ‹¦æˆªå¼¹çª—æ ·å¼ */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .intercept-modal {
            background: linear-gradient(135deg, #0c0c0c, #1a1a1a);
            width: 90%;
            max-width: 500px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 0 40px rgba(255, 0, 0, 0.5);
            border: 2px solid #ff3333;
            animation: pulse 1.5s infinite alternate;
        }
        
        @keyframes pulse {
            from { box-shadow: 0 0 20px rgba(255, 0, 0, 0.5); }
            to { box-shadow: 0 0 40px rgba(255, 0, 0, 0.8); }
        }
        
        .modal-header {
            background: #ff3333;
            padding: 20px;
            text-align: center;
        }
        
        .modal-header h2 {
            color: white;
            font-size: 1.8rem;
        }
        
        .modal-body {
            padding: 30px;
            text-align: center;
        }
        
        .modal-body p {
            margin-bottom: 20px;
            line-height: 1.6;
            font-size: 1.1rem;
        }
        
        .warning-icon {
            font-size: 4rem;
            color: #ff3333;
            margin-bottom: 20px;
        }
        
        .countdown {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ff5252;
            margin: 20px 0;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #90a4ae;
            font-size: 0.9rem;
        }
        
        .request-log {
            max-height: 200px;
            overflow-y: auto;
            margin-top: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            padding: 10px;
        }
        
        .log-entry {
            padding: 5px 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            font-family: monospace;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>DDoSæ”»å‡»æ£€æµ‹ä¸é˜²æŠ¤ç³»ç»Ÿ</h1>
            <p class="subtitle">å®æ—¶ç›‘æ§è¯·æ±‚æµé‡ï¼Œæ£€æµ‹å¼‚å¸¸è®¿é—®æ¨¡å¼ï¼Œè‡ªåŠ¨è§¦å‘é˜²æŠ¤æœºåˆ¶</p>
        </header>
        
        <div class="dashboard">
            <div class="card">
                <h2>ç³»ç»ŸçŠ¶æ€</h2>
                <div class="stat">
                    <span>å½“å‰çŠ¶æ€ï¼š</span>
                    <span id="status" class="stat-value safe">æ­£å¸¸</span>
                </div>
                <div class="stat">
                    <span>è¯·æ±‚é¢‘ç‡ï¼š</span>
                    <span id="requestRate" class="stat-value">0 æ¬¡/ç§’</span>
                </div>
                <div class="stat">
                    <span>IPè¿æ¥æ•°ï¼š</span>
                    <span id="ipConnections" class="stat-value">1</span>
                </div>
                <div class="stat">
                    <span>æ”»å‡»æ£€æµ‹é˜ˆå€¼ï¼š</span>
                    <span id="threshold" class="stat-value">50 æ¬¡/ç§’</span>
                </div>
                <div class="stat">
                    <span>å·²æ‹¦æˆªæ”»å‡»ï¼š</span>
                    <span id="blockedAttacks" class="stat-value">0 æ¬¡</span>
                </div>
            </div>
            
            <div class="card">
                <h2>è¯·æ±‚ç›‘æ§</h2>
                <div id="requestChart" class="chart-container"></div>
                <div class="controls">
                    <button id="simulateAttack" class="simulate-btn">æ¨¡æ‹ŸDDoSæ”»å‡»</button>
                    <button id="stopAttack" class="stop-btn" disabled>åœæ­¢æ”»å‡»æ¨¡æ‹Ÿ</button>
                    <button id="resetStats" class="reset-btn">é‡ç½®æ•°æ®</button>
                </div>
            </div>
            
            <div class="card">
                <h2>è¯·æ±‚æ—¥å¿—</h2>
                <div>æœ€è¿‘è¯·æ±‚è®°å½•ï¼š</div>
                <div id="requestLog" class="request-log">
                    <!-- è¯·æ±‚æ—¥å¿—å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>æœ¬ç³»ç»Ÿä¸ºæ¼”ç¤ºç”¨é€”ï¼Œå±•ç¤ºDDoSæ”»å‡»æ£€æµ‹ä¸é˜²æŠ¤çš„åŸºæœ¬åŸç†ã€‚çœŸå®ç¯å¢ƒä¸­éœ€ç»“åˆæœåŠ¡å™¨ç«¯é˜²æŠ¤æªæ–½ã€‚</p>
            <p>Â© 2025 ç½‘ç»œå®‰å…¨é˜²æŠ¤ç³»ç»Ÿ | æ£€æµ‹åˆ°æ”»å‡»æ—¶å°†è‡ªåŠ¨è§¦å‘æ‹¦æˆªæœºåˆ¶</p>
        </div>
    </div>
    
    <!-- æ‹¦æˆªå¼¹çª— -->
    <div id="interceptOverlay" class="overlay">
        <div class="intercept-modal">
            <div class="modal-header">
                <h2>âš ï¸ å®‰å…¨è­¦å‘Š - æ£€æµ‹åˆ°å¼‚å¸¸æµé‡</h2>
            </div>
            <div class="modal-body">
                <div class="warning-icon">ğŸš¨</div>
                <p>ç³»ç»Ÿæ£€æµ‹åˆ°å¼‚å¸¸é«˜é¢‘ç‡è¯·æ±‚ï¼Œç–‘ä¼¼DDoSæ”»å‡»è¡Œä¸ºã€‚</p>
                <p>å½“å‰è¯·æ±‚é¢‘ç‡å·²è¶…è¿‡å®‰å…¨é˜ˆå€¼ï¼Œç³»ç»Ÿå·²è‡ªåŠ¨å¯ç”¨é˜²æŠ¤æªæ–½ã€‚</p>
                <p>è¯·ç¡®è®¤æ‚¨æ˜¯æ­£å¸¸ç”¨æˆ·ï¼Œå¹¶åœ¨ä¸‹æ–¹éªŒè¯åç»§ç»­è®¿é—®ï¼š</p>
                
                <div class="countdown" id="countdown">10</div>
                
                <p>å¦‚æœè¿™æ˜¯è¯¯æŠ¥ï¼Œè¯·åœ¨å€’è®¡æ—¶ç»“æŸåç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ç»§ç»­è®¿é—®ã€‚</p>
                <button id="continueBtn" style="background: #4caf50; color: white; padding: 12px 30px; margin-top: 15px;">
                    æˆ‘æ˜¯æ­£å¸¸ç”¨æˆ·ï¼Œç»§ç»­è®¿é—®
                </button>
            </div>
        </div>
    </div>

    <script>
        // ç³»ç»ŸçŠ¶æ€å˜é‡
        let requestCount = 0;
        let attackDetected = false;
        let attackSimulation = false;
        let blockedAttacks = 0;
        let requestRate = 0;
        let requestTimestamps = [];
        let ipConnections = 1;
        let requestLog = [];
        
        // é…ç½®å‚æ•°
        const DETECTION_THRESHOLD = 50; // è¯·æ±‚/ç§’é˜ˆå€¼
        const MONITORING_WINDOW = 10000; // ç›‘æ§æ—¶é—´çª—å£(10ç§’)
        const INTERCEPT_DURATION = 10; // æ‹¦æˆªå€’è®¡æ—¶ç§’æ•°
        
        // DOMå…ƒç´ 
        const statusElement = document.getElementById('status');
        const requestRateElement = document.getElementById('requestRate');
        const ipConnectionsElement = document.getElementById('ipConnections');
        const blockedAttacksElement = document.getElementById('blockedAttacks');
        const requestLogElement = document.getElementById('requestLog');
        const simulateAttackBtn = document.getElementById('simulateAttack');
        const stopAttackBtn = document.getElementById('stopAttack');
        const resetStatsBtn = document.getElementById('resetStats');
        const interceptOverlay = document.getElementById('interceptOverlay');
        const continueBtn = document.getElementById('continueBtn');
        const countdownElement = document.getElementById('countdown');
        
        // å›¾è¡¨æ•°æ®
        let requestRateHistory = [];
        const MAX_HISTORY = 20;
        
        // åˆå§‹åŒ–
        function init() {
            // åˆå§‹åŒ–å›¾è¡¨
            initChart();
            
            // æ¨¡æ‹Ÿæ­£å¸¸è¯·æ±‚æµé‡
            simulateNormalTraffic();
            
            // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
            simulateAttackBtn.addEventListener('click', startAttackSimulation);
            stopAttackBtn.addEventListener('click', stopAttackSimulation);
            resetStatsBtn.addEventListener('click', resetStatistics);
            continueBtn.addEventListener('click', closeInterceptModal);
            
            // æ›´æ–°æ˜¾ç¤º
            updateDisplay();
            
            console.log("DDoSæ£€æµ‹ç³»ç»Ÿå·²å¯åŠ¨ã€‚é˜ˆå€¼: " + DETECTION_THRESHOLD + " è¯·æ±‚/ç§’");
        }
        
        // æ¨¡æ‹Ÿæ­£å¸¸æµé‡
        function simulateNormalTraffic() {
            // éšæœºç”Ÿæˆæ­£å¸¸è¯·æ±‚
            setInterval(() => {
                if (attackSimulation) return; // æ”»å‡»æ¨¡æ‹ŸæœŸé—´ä¸ç”Ÿæˆæ­£å¸¸è¯·æ±‚
                
                const normalRequests = Math.floor(Math.random() * 5) + 1; // 1-5ä¸ªè¯·æ±‚
                for (let i = 0; i < normalRequests; i++) {
                    logRequest('normal');
                }
            }, 1000);
        }
        
        // è®°å½•è¯·æ±‚
        function logRequest(type) {
            const now = Date.now();
            requestTimestamps.push(now);
            requestCount++;
            
            // æ¸…ç†æ—§çš„æ—¶é—´æˆ³ï¼ˆè¶…è¿‡ç›‘æ§çª—å£ï¼‰
            requestTimestamps = requestTimestamps.filter(timestamp => 
                now - timestamp < MONITORING_WINDOW
            );
            
            // è®¡ç®—å½“å‰è¯·æ±‚ç‡
            requestRate = Math.round((requestTimestamps.length / (MONITORING_WINDOW / 1000)) * 10) / 10;
            
            // è®°å½•åˆ°æ—¥å¿—
            const logEntry = {
                time: new Date().toLocaleTimeString(),
                type: type,
                ip: generateRandomIP(),
                userAgent: navigator.userAgent.substring(0, 30) + '...'
            };
            
            requestLog.unshift(logEntry);
            if (requestLog.length > 10) requestLog.pop();
            
            // æ£€æµ‹æ”»å‡»
            detectAttack();
            
            // æ›´æ–°æ˜¾ç¤º
            updateDisplay();
        }
        
        // ç”ŸæˆéšæœºIPï¼ˆç”¨äºæ¼”ç¤ºï¼‰
        function generateRandomIP() {
            return `192.168.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`;
        }
        
        // æ£€æµ‹æ”»å‡»
        function detectAttack() {
            if (attackDetected) return; // å·²ç»æ£€æµ‹åˆ°æ”»å‡»
            
            // æ£€æŸ¥è¯·æ±‚ç‡æ˜¯å¦è¶…è¿‡é˜ˆå€¼
            if (requestRate > DETECTION_THRESHOLD) {
                attackDetected = true;
                blockedAttacks++;
                
                // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
                statusElement.textContent = "æ”»å‡»æ£€æµ‹";
                statusElement.className = "stat-value danger";
                
                // æ˜¾ç¤ºæ‹¦æˆªå¼¹çª—
                showInterceptModal();
                
                console.log(`ğŸš¨ æ£€æµ‹åˆ°DDoSæ”»å‡»ï¼è¯·æ±‚ç‡: ${requestRate} æ¬¡/ç§’ï¼Œè¶…è¿‡é˜ˆå€¼: ${DETECTION_THRESHOLD} æ¬¡/ç§’`);
            } else if (requestRate > DETECTION_THRESHOLD * 0.7) {
                // æ¥è¿‘é˜ˆå€¼ï¼Œè­¦å‘ŠçŠ¶æ€
                statusElement.textContent = "è­¦å‘Š";
                statusElement.className = "stat-value warning";
            } else {
                statusElement.textContent = "æ­£å¸¸";
                statusElement.className = "stat-value safe";
            }
        }
        
        // æ˜¾ç¤ºæ‹¦æˆªå¼¹çª—
        function showInterceptModal() {
            interceptOverlay.style.display = "flex";
            
            // å¼€å§‹å€’è®¡æ—¶
            let countdown = INTERCEPT_DURATION;
            countdownElement.textContent = countdown;
            
            const countdownInterval = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    closeInterceptModal();
                }
            }, 1000);
        }
        
        // å…³é—­æ‹¦æˆªå¼¹çª—
        function closeInterceptModal() {
            interceptOverlay.style.display = "none";
            attackDetected = false;
            
            // é‡ç½®è¯·æ±‚è®¡æ•°
            requestTimestamps = [];
            requestRate = 0;
            
            // æ›´æ–°çŠ¶æ€
            statusElement.textContent = "æ­£å¸¸";
            statusElement.className = "stat-value safe";
            
            console.log("âœ… æ‹¦æˆªå·²è§£é™¤ï¼Œç³»ç»Ÿæ¢å¤æ­£å¸¸çŠ¶æ€");
        }
        
        // å¼€å§‹æ”»å‡»æ¨¡æ‹Ÿ
        function startAttackSimulation() {
            attackSimulation = true;
            simulateAttackBtn.disabled = true;
            stopAttackBtn.disabled = false;
            
            console.log("âš¡ å¼€å§‹æ¨¡æ‹ŸDDoSæ”»å‡»...");
            
            // é«˜é¢‘ç‡ç”Ÿæˆæ”»å‡»è¯·æ±‚
            const attackInterval = setInterval(() => {
                if (!attackSimulation) {
                    clearInterval(attackInterval);
                    return;
                }
                
                // ç”Ÿæˆå¤§é‡è¯·æ±‚
                const attackRequests = Math.floor(Math.random() * 30) + 20; // 20-50ä¸ªè¯·æ±‚
                for (let i = 0; i < attackRequests; i++) {
                    logRequest('attack');
                }
            }, 100); // æ¯100msç”Ÿæˆä¸€æ‰¹è¯·æ±‚
            
            // éšæœºåœæ­¢æ”»å‡»æ¨¡æ‹Ÿï¼ˆé˜²æ­¢æ— é™è¿›è¡Œï¼‰
            setTimeout(() => {
                if (attackSimulation) {
                    stopAttackSimulation();
                    console.log("â¹ï¸ æ”»å‡»æ¨¡æ‹Ÿå·²è‡ªåŠ¨åœæ­¢");
                }
            }, 15000);
        }
        
        // åœæ­¢æ”»å‡»æ¨¡æ‹Ÿ
        function stopAttackSimulation() {
            attackSimulation = false;
            simulateAttackBtn.disabled = false;
            stopAttackBtn.disabled = true;
            
            console.log("âœ… æ”»å‡»æ¨¡æ‹Ÿå·²åœæ­¢");
        }
        
        // é‡ç½®ç»Ÿè®¡æ•°æ®
        function resetStatistics() {
            requestCount = 0;
            requestRate = 0;
            requestTimestamps = [];
            blockedAttacks = 0;
            requestRateHistory = [];
            requestLog = [];
            attackDetected = false;
            attackSimulation = false;
            
            simulateAttackBtn.disabled = false;
            stopAttackBtn.disabled = true;
            
            statusElement.textContent = "æ­£å¸¸";
            statusElement.className = "stat-value safe";
            
            updateDisplay();
            updateChart();
            
            console.log("ğŸ”„ ç»Ÿè®¡æ•°æ®å·²é‡ç½®");
        }
        
        // æ›´æ–°æ˜¾ç¤º
        function updateDisplay() {
            requestRateElement.textContent = requestRate.toFixed(1) + " æ¬¡/ç§’";
            ipConnectionsElement.textContent = Math.max(1, Math.floor(requestRate / 5));
            blockedAttacksElement.textContent = blockedAttacks + " æ¬¡";
            
            // æ›´æ–°è¯·æ±‚æ—¥å¿—æ˜¾ç¤º
            requestLogElement.innerHTML = '';
            requestLog.forEach(log => {
                const logElement = document.createElement('div');
                logElement.className = 'log-entry';
                logElement.innerHTML = `
                    <span style="color: ${log.type === 'attack' ? '#ff5252' : '#69f0ae'}">â—</span>
                    ${log.time} | ${log.ip} | ${log.userAgent}
                `;
                requestLogElement.appendChild(logElement);
            });
            
            // æ›´æ–°å›¾è¡¨æ•°æ®
            if (requestRateHistory.length >= MAX_HISTORY) {
                requestRateHistory.shift();
            }
            requestRateHistory.push(requestRate);
            updateChart();
        }
        
        // åˆå§‹åŒ–å›¾è¡¨
        function initChart() {
            // åˆ›å»ºç®€å•çš„SVGå›¾è¡¨
            const chartContainer = document.getElementById('requestChart');
            chartContainer.innerHTML = '<svg width="100%" height="100%" id="requestChartSVG"></svg>';
        }
        
        // æ›´æ–°å›¾è¡¨
        function updateChart() {
            const svg = document.getElementById('requestChartSVG');
            if (!svg) return;
            
            svg.innerHTML = '';
            
            const width = svg.clientWidth;
            const height = svg.clientHeight;
            const padding = 20;
            const chartWidth = width - padding * 2;
            const chartHeight = height - padding * 2;
            
            if (requestRateHistory.length < 2) return;
            
            // è®¡ç®—Yè½´æœ€å¤§å€¼
            const maxRate = Math.max(...requestRateHistory, DETECTION_THRESHOLD);
            
            // ç»˜åˆ¶åæ ‡è½´
            const axis = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            axis.setAttribute('d', 
                `M ${padding} ${height - padding} L ${width - padding} ${height - padding} M ${padding} ${padding} L ${padding} ${height - padding}`
            );
            axis.setAttribute('stroke', 'rgba(255, 255, 255, 0.3)');
            axis.setAttribute('fill', 'none');
            svg.appendChild(axis);
            
            // ç»˜åˆ¶é˜ˆå€¼çº¿
            const thresholdLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            const thresholdY = height - padding - (DETECTION_THRESHOLD / maxRate) * chartHeight;
            thresholdLine.setAttribute('x1', padding);
            thresholdLine.setAttribute('y1', thresholdY);
            thresholdLine.setAttribute('x2', width - padding);
            thresholdLine.setAttribute('y2', thresholdY);
            thresholdLine.setAttribute('stroke', '#ff5252');
            thresholdLine.setAttribute('stroke-dasharray', '5,5');
            svg.appendChild(thresholdLine);
            
            // ç»˜åˆ¶é˜ˆå€¼æ ‡ç­¾
            const thresholdLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            thresholdLabel.setAttribute('x', width - padding - 40);
            thresholdLabel.setAttribute('y', thresholdY - 5);
            thresholdLabel.setAttribute('fill', '#ff5252');
            thresholdLabel.setAttribute('font-size', '12');
            thresholdLabel.textContent = 'é˜ˆå€¼';
            svg.appendChild(thresholdLabel);
            
            // ç»˜åˆ¶æŠ˜çº¿
            const points = [];
            for (let i = 0; i < requestRateHistory.length; i++) {
                const x = padding + (i / (requestRateHistory.length - 1)) * chartWidth;
                const y = height - padding - (requestRateHistory[i] / maxRate) * chartHeight;
                points.push(`${x},${y}`);
            }
            
            const line = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');
            line.setAttribute('points', points.join(' '));
            line.setAttribute('fill', 'none');
            line.setAttribute('stroke', '#4fc3f7');
            line.setAttribute('stroke-width', '2');
            svg.appendChild(line);
            
            // ç»˜åˆ¶æ•°æ®ç‚¹
            points.forEach((point, i) => {
                const [x, y] = point.split(',').map(Number);
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', x);
                circle.setAttribute('cy', y);
                circle.setAttribute('r', 3);
                circle.setAttribute('fill', requestRateHistory[i] > DETECTION_THRESHOLD ? '#ff5252' : '#4fc3f7');
                svg.appendChild(circle);
            });
            
            // æ·»åŠ Yè½´æ ‡ç­¾
            const yLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            yLabel.setAttribute('x', padding + 5);
            yLabel.setAttribute('y', padding + 15);
            yLabel.setAttribute('fill', '#b0bec5');
            yLabel.setAttribute('font-size', '12');
            yLabel.textContent = 'è¯·æ±‚/ç§’';
            svg.appendChild(yLabel);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', init);
        
        // çª—å£å¤§å°æ”¹å˜æ—¶é‡ç»˜å›¾è¡¨
        window.addEventListener('resize', updateChart);
    </script>
</body>
</html>
